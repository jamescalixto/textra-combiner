# textra-combiner

data wrangling to combine text message backups from Textra and SMS Backup and Restore

## Motivation

For the full story, refer to [this post](https://jamescalixto.com/textra-combiner/). TL;DR: Textra didn't sync with the stock database so I couldn't transfer texts to a new phone, the only export feature uses a not-readily-parseable format, and I needed to combine that with messages from SMS Backup and Restore. Thus I wrote this script to do that.

## Usage

Using Python 3.x, run the `textra-combiner.py` script from the command line. For example: `python3 textra-combiner.py --xml "sample_data/sample_export.xml" --textra "curiousgeorge.txt" "paddington.txt" --strip-invalid-addr --fix-sent-from-addr --output "sample_data/output.xml"`

It takes the following arguments:

### `xml`

The path to an optional XML file generated by [SMS Backup and Restore](https://play.google.com/store/apps/details?id=com.riteshsahu.SMSBackupRestore). This takes in a single argument because you should only need one of these backup files.

### `textra`

The paths to optional text files from Textra, generated with the "Share as email" button. This can take in multiple space-separated and quoted arguments since each conversation is a separate file.

### `strip`

If messages match these arguments exactly, they are stripped from the output. Useful for phrases such as "You sent a picture" that represent actual MMS messages in the XML backup. This can take in multiple space-separated and quoted arguments.

### `strip-invalid-addr`

If this flag is used, strips the MMS address "insert-address-token", which may cause all MMS messages to show up from "Unknown sender" or "Anonymous".

### `fix-sent-from-addr`

If this flag is used, attempts to fix an issue where there is no address attribute in MMS elements that are backed up by SMS Backup and Restore.

### `output`

The path to the desired output.

## Procedure

I am making assumptions that include:

- you have an Android phone where your texts are stored in Textra and not synced with the stock database,
- you have not deleted them or otherwise made them inaccessible,
- you can install [SMS Backup and Restore](https://play.google.com/store/apps/details?id=com.riteshsahu.SMSBackupRestore) from the Play Store,
- you have a device that can run Python 3.x.

To use this script:

1. In Textra, open a conversation you want to save, tap on the chevron at the top right, and tap "Share as email." This will allow you to export that conversation as a text file. Do this for every conversation you wish to save.

2. Install [SMS Backup and Restore](https://play.google.com/store/apps/details?id=com.riteshsahu.SMSBackupRestore) and make a backup XML file.

3. Transfer the XML file and the texts files to the device that can run the script.

4. Run the script, passing in the XML filepath after the `xml` flag and the text filepaths after the `textra` flag. Use the other flags as desired.

5. Transfer the output XML file to the device you want to load the messages onto.

6. Use SMS Backup and Restore to load and restore the output XML file.
